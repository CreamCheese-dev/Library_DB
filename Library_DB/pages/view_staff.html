<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Staff Members</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Page title -->
    <h1>View Staff Members</h1>

    <!-- Table to display staff member data -->
    <table id="staffTable">
        <thead>
            <tr>
                <th>Staff ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Position</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <!-- Dynamic staff rows will be inserted here via JavaScript -->
        </tbody>
    </table>

<script>
    // Fetch and populate the table with staff data on page load
    window.onload = function() {
        populateTable();
    };

    // Populate the table with staff data
    function populateTable() {
        fetch('http://read-renaissance.com/api/staff')
        .then(response => response.json())
        .then(data => {
            const tableBody = document.getElementById('staffTable').getElementsByTagName('tbody')[0];
            tableBody.innerHTML = ''; // Clear the table first
            data.forEach(staff => {
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td>${staff.staffId}</td>
                    <td>${staff.firstName}</td>
                    <td>${staff.lastName}</td>
                    <td>${staff.position}</td>
                    <td>
                        <button onclick="window.location.href='edit_pages/edit_staff.html?staffId=${staff.staffId}'">Edit</button>
                        <button onclick="deleteStaff('${staff.staffId}')">Delete</button>
                    </td>
                `;
            });
        })
        .catch(error => console.error('Error loading staff data:', error));
    }

    // Function to delete a staff member
    function deleteStaff(staffId) {
        fetch(`http://read-renaissance.com/api/staff/${staffId}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(result => {
            console.log(result); // Log the result for debugging
            populateTable(); // Refresh the table after deletion
        })
        .catch(error => console.error('Error deleting staff member:', error));
    }
</script>

</body>
</html>
